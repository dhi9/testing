<!-- start: PAGE TITLE -->
<section id="page-title" class="padding-top-15 padding-bottom-15" >
	<div class="row">
		<div class="col-sm-7">
			<h1 class="mainTitle">Test</h1>
		</div>
		<div ncy-breadcrumb></div>
	</div>
</section>
<!-- end: PAGE TITLE -->

<style type="text/css">
	#barcodescanner {
	  width: 320px; height: 240px;
	}
	video { width: 420px; height: 340px; }
	
	#barcodescanner > #inner {
	  width: 390px; height: 280px;
	  border: 30px solid rgba(64,64,64, 0.5);
	  zindex: 1000;
	}
	#barcodescanner > #redline {
	  top: 120px;
	  width: 320px;
	  height: 2px;
	  background-color: rgba(255, 0, 0, 0.3);
	  z-index: 1001;
	}
  </style>

<!-- start: YOUR CONTENT HERE -->

<div ng-controller="barcodeGeneratorController">  

<div class="container-fluid container-fullw">
	<div class="row" ng-show="barcodeValue.length > 0 " >
		<div class="col-md-12">
			<center>
				<div id="barcodescanner">
					<video autoplay></video>
					<div id="inner"></div>
					<div id="redline"></div>
				</div>
				<canvas style="display:none;"></canvas>
			</center>
		</div>
	</div>
     <div class="row">
		<div class="col-md-12">
			<div class="panel panel-white" id="pnlCustomerDetail">
				<div collapse="pnlCustomerDetail" ng-init="pnlCustomerDetail=false" class="panel-wrapper">
					<div class="panel-body">
						<form class="form-horizontal">
							<div class="row">
								<div class="col-md-12">
									<ul id="decoded"></ul>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	 

		
	 
	 
	 
	 
		<button class="btn btn-primary" ui-sref="app.tools.qrscanner">Kembali</button>
	                            
</div><!-- End of Customer Row -->

</div>

<!-- end: YOUR CONTENT HERE -->
      
	  
      
      
      
	  
	  

<script type="text/javascript">
        var video = document.querySelector('video');
        var canvas = document.querySelector('canvas');
        var ctx = canvas.getContext('2d');
        var localMediaStream = null;
        var list = document.querySelector('ul#decoded');

        var worker = new Worker('http://localhost:8080/zbar-processor.js');
        worker.onmessage = function(event) {
            if (event.data.length == 0) return;
            var d = event.data[0];
            var entry = document.createElement('li');
            entry.appendChild(document.createTextNode(d[2] + ' (' + d[0] + ')'));
            list.appendChild(entry);
        };

        function snapshot() {
            if (localMediaStream === null) return;
            var k = (320 + 240) / (video.videoWidth + video.videoHeight);
            canvas.width = Math.ceil(video.videoWidth * k);
            canvas.height = Math.ceil(video.videoHeight * k);
            var ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight,
                          0, 0, canvas.width, canvas.height);

            var data = ctx.getImageData(0, 0, canvas.width, canvas.height);
            worker.postMessage(data);
        }

        setInterval(snapshot, 500);

        navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
        window.URL = window.URL || window.webkitURL || window.mozURL || window.msURL;

        if (navigator.getUserMedia) {
            navigator.getUserMedia({video: true},
                                   function(stream) { // success callback
                                       if (video.mozSrcObject !== undefined) {
                                           video.mozSrcObject = stream;
                                       } else {
                                           video.src = (window.URL && window.URL.createObjectURL(stream)) || stream;
                                       }
                                       localMediaStream = true;
                                   },
                                   function(error) {
                                       console.error(error);
                                   });
        }
        else {
        }
      </script>