/*
    *
    * Wijmo Library 5.20153.109
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the Wijmo Commercial License.
    * sales@wijmo.com
    * http://wijmo.com/products/wijmo-5/license/
    *
    */
var wijmo;(function(n){(function(t){(function(i){'use strict';var r=function(){function i(){}return i.export=function(t,i){var r=this.toWorkbookOM(t,i);return n.xlsx.XlsxConverter.export(r)},i.import=function(t,i,r,u){var f=n.xlsx.XlsxConverter.import(t);this.fromWorkbookOM(f,i,r,u)},i.toWorkbookOM=function(t,i){var r={sheets:[],creator:'',created:new Date,lastModifiedBy:'',modified:new Date,activeWorksheet:0},u,f;if(i&&i.activeWorksheet!=null&&i.activeWorksheet>0&&(r.activeWorksheet=i.activeWorksheet),n.isArray(t))for(u=0;u<t.length;u++)f=t[u],this._exportFlexGrid(f,r,i);else this._exportFlexGrid(t,r,i);return r},i.fromWorkbookOM=function(i,r,u,f){var ti=u?u.includeColumnHeader:!0,y=u?u.includeColumnHeader:!0,bt=1,k=0,e=0,h=0,tt,it,rt,p,w,ut,at,d,kt,s,c,g,ft,l,et,ot,dt,vt,v,st,b,a,gt,ht,o,yt,pt,ct,ni,nt,wt=!1,lt={};if(r.itemsSource=null,r.columns.clear(),r.rows.clear(),r.frozenColumns=0,r.frozenRows=0,i.sheets.length!==0)for(f&&(bt=i.sheets.length);k<bt;k++){for(yt={},pt={},h=0,rt=[],ct=[],c=i.sheets[k],ti&&(h=1,c.rows.length<=1&&(y=!1,h=0),at=c.rows[0]),g=this._getColumnCount(c.rows),dt=c.summaryBelow,k>0&&(gt=document.createElement('div'),r=new t.FlexGrid(gt)),e=0;e<g;e++)r.columns.push(new t.Column),!c.cols[e]||(isNaN(+c.cols[e].width)||(r.columns[e].width=+c.cols[e].width),c.cols[e].visible||c.cols[e].visible==undefined||(r.columns[e].visible=!!c.cols[e].visible));for(;h<c.rows.length;h++){if(ft=!1,s=c.rows[h],s)for(et=h+1;et<c.rows.length;)if(ot=c.rows[et],ot){(isNaN(s.groupLevel)&&!isNaN(ot.groupLevel)||!isNaN(s.groupLevel)&&s.groupLevel<ot.groupLevel)&&(ft=!0);break}else et++;for(ft&&!dt?(v&&(v.isCollapsed=wt),v=new t.GroupRow,wt=s.collapsed==null?!1:s.collapsed,v.level=isNaN(s.groupLevel)?0:s.groupLevel,lt[v.level]=wt,this._checkParentCollapsed(lt,v.level)&&v._setFlag(128,!0),r.rows.push(v)):(vt=new t.Row,s&&this._checkParentCollapsed(lt,s.groupLevel)&&vt._setFlag(128,!0),r.rows.push(vt)),!s||!s.height||isNaN(s.height)||(r.rows[y?h-1:h].height=s.height),e=0;e<g;e++)if(s){if(l=s.cells[e],a=l?l.formula:undefined,a&&a[0]!=='='&&(a='='+a),a=a?this._parseToFlexSheetFormula(a):undefined,r.setCellData(y?h-1:h,e,a&&f?a:this._getItemValue(l)),!ft&&l&&l.value!=null&&l.value!==''&&this._setColumn(rt,e,l),ht=h*g+e,o=l?l.style:undefined,o){if(ni=this._getItemType(l),o.hAlign)nt=n.xlsx.XlsxConverter._parseHAlignToString(n.asEnum(o.hAlign,n.xlsx.HAlign));else switch(ni){case 2:nt='right';break;case 3:nt='center';break;default:nt='left'}yt[ht]={fontWeight:o.font&&o.font.bold?'bold':'none',fontStyle:o.font&&o.font.italic?'italic':'none',textDecoration:o.font&&o.font.underline?'underline':'none',textAlign:nt,fontFamily:o.font&&o.font.family?o.font.family:'',fontSize:o.font&&o.font.size?o.font.size+'px':'',color:o.font&&o.font.color?o.font.color:'',backgroundColor:o.fill&&o.fill.color?o.fill.color:'',format:n.xlsx.XlsxConverter._parseExcelFormat(l)};o.font&&ct.indexOf(o.font.family)===-1&&ct.push(o.font.family)}if(l&&n.isNumber(l.rowSpan)&&n.isNumber(l.colSpan))for(tt=h;tt<h+l.rowSpan;tt++)for(it=e;it<e+l.colSpan;it++)ht=tt*g+it,pt[ht]=new t.CellRange(h,e,h+l.rowSpan-1,e+l.colSpan-1)}else r.setCellData(y?h-1:h,e,''),this._setColumn(rt,e,undefined);!s||this._checkParentCollapsed(lt,s.groupLevel)||s.visible||s.visible==undefined||(r.rows[y?h-1:h].visible=s.visible)}for(c.frozenPane&&(st=c.frozenPane.columns,n.isNumber(st)&&!isNaN(st)&&(r.frozenColumns=st),b=c.frozenPane.rows,n.isNumber(b)&&!isNaN(b)&&(r.frozenRows=y&&b>0?b-1:b)),e=0;e<r.columnHeaders.columns.length;e++)p=rt[e],w=r.columns[e],w.required=!1,y?(d=at?at.cells[e]:undefined,d&&d.value?(kt=n.xlsx.XlsxConverter._parseExcelFormat(d),ut=n.Globalize.format(d.value,kt)):ut=this._numAlpha(e)):ut=this._numAlpha(e),w.header=ut,p&&(p.dataType===3&&(w.dataType=p.dataType),w.format=p.format,w.align=p.hAlign);f&&(r.wj_sheetInfo={name:c.name,visible:c.visible!==!1,styledCells:yt,mergedRanges:pt,fonts:ct});f&&k>0&&f.push(r)}},i._exportFlexGrid=function(i,r,u){var k=[],h=[],a={cols:[],rows:[],summaryBelow:!1},nt=u?u.includeColumnHeaders!=null?u.includeColumnHeaders:u.includeColumnHeader!=null?u.includeColumnHeader:!0:!0,w=u?u.includeRowHeaders!=null?u.includeRowHeaders:!1:!1,v=u?u.includeCellStyles!=null?u.includeCellStyles:u.needGetCellStyle!=null?u.needGetCellStyle:!0:!0,o,y,p,e,f,l,c,d,tt,b,g=0,it=0,s=0;if(l=i.wj_sheetInfo,a.name=l?l.name:'',a.visible=l?l.visible!==!1:!0,!l&&v&&(c=document.createElement('div'),c.style.visibility='hidden',i.hostElement.appendChild(c)),w){for(f=0;f<i.rowHeaders.columns.length;f++)y=i.rowHeaders.columns[f],p=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),h[f]=p;s=f}if(nt&&i.columnHeaders.rows.length>0){for(e=0;e<i.columnHeaders.rows.length;e++){if(e===0)for(f=0;f<i.columnHeaders.columns.length;f++)y=i.columnHeaders.columns[f],p=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),h[s+f]=p;s=0;o={};w&&(s=this._parseFlexGridRowToSheetRow(i.topLeftCells,o,e,0,h,v,c,!1,0));this._parseFlexGridRowToSheetRow(i.columnHeaders,o,e,s,h,v,c,!1,0);o.cells.length>0&&(k[e]=o)}it=e}else for(f=0;f<i.columnHeaders.columns.length;f++)y=i.columnHeaders.columns[f],p=this._getColumnSetting(y,i.columnHeaders.columns.defaultSize),h[s+f]=p;for(a.cols=h,e=0;e<i.cells.rows.length;e++)s=0,o={},d=i.rows[e],b=d instanceof t.GroupRow,b&&(tt=n.tryCast(d,t.GroupRow),g=tt.level+1),w&&(s=this._parseFlexGridRowToSheetRow(i.rowHeaders,o,e,0,h,v,c,b,g)),this._parseFlexGridRowToSheetRow(i.cells,o,e,s,h,v,c,b,g),o.cells.length>0&&(k[it+e]=o);a.rows=k;a.frozenPane={rows:nt?i.frozenRows+i.columnHeaders.rows.length:i.frozenRows,columns:w?i.frozenColumns+i.rowHeaders.columns.length:i.frozenColumns};r.sheets.push(a);!l&&v&&i.hostElement.removeChild(c)},i._parseFlexGridRowToSheetRow=function(t,i,r,u,f,e,o,s,h){var p,l,tt,c,b,a,k,it,d,ut,v,y,nt,rt,g,w,ft=!1;for(p=t.grid,g=p.wj_sheetInfo,l=t.rows[r],i.cells||(i.cells=[]),i.visible=l.isVisible,i.height=l.renderHeight||t.rows.defaultSize,i.groupLevel=s?h-1:h,s&&(i.collapsed=l.isCollapsed),(l.constructor===n.grid.Row||l.constructor===n.grid._NewRowTemplate||n.grid.detail&&l.constructor===n.grid.detail.DetailRow)&&(ft=!0),c=0;c<t.columns.length;c++){if(rt=1,nt=1,y=null,g&&t===p.cells?(ut=r*t.columns.length+c,g.mergedRanges&&(y=g.mergedRanges[ut]),g.styledCells&&(v=g.styledCells[ut])):e&&(v=this._getCellStyle(t,o,r,c)||{}),y||(y=p.getMergedRange(t,r,c,!1)),y)if(r===y.topRow&&c===y.leftCol)nt=y.bottomRow-y.topRow+1,rt=y.rightCol-y.leftCol+1;else continue;if(tt=f[c],ft||s?(a=t.getCellData(r,c,!0),k=t.getCellData(r,c,!1),d=!1,a&&n.isString(a)&&a.length>1&&a[0]==='='&&(d=!0),w=n.isDate(k)||d&&a.toLowerCase()==='=now()',b=v&&v.format?n.xlsx.XlsxConverter._parseCellFormat(v.format,w):tt.style.format,b||(b=w?'m/d/yyyy':n.isNumber(k)&&!t.columns[c].dataMap?n.isInt(k)?'#,##0':'#,##0.00':'General')):(a=p.columnHeaders.getCellData(0,c,!0),b='General'),t===p.cells&&s&&l.hasChildren&&c===p.columns.firstVisibleIndex){if(it=a?a:l.dataItem&&l.dataItem.groupDescription?l.dataItem.groupDescription.propertyName+': '+l.dataItem.name+' ('+l.dataItem.items.length+' items)':'',it==null&&!v)continue;w=n.isDate(it);i.cells[u+c]={value:it,isDate:w,formula:d?this._parseToExcelFormula(a,w):null,colSpan:rt,rowSpan:nt,style:this._extend(this._parseCellStyle(v),{format:b,font:{bold:!0},hAlign:1,indent:h-1})}}else{if(!a&&k==null&&!v)continue;i.cells[u+c]={value:d?undefined:b==='General'?a:k,isDate:w,formula:d?this._parseToExcelFormula(a,w):null,colSpan:rt,rowSpan:nt,style:this._extend(this._parseCellStyle(v),{format:b,hAlign:v&&v.textAlign?n.xlsx.XlsxConverter._parseStringToHAlign(v.textAlign):n.isDate(k)&&tt.style.hAlign==null?1:n.asEnum(tt.style.hAlign,n.xlsx.HAlign,!0),vAlign:nt>1?t===p.cells?0:1:null})}}}return u+c},i._parseCellStyle=function(t){var i=t&&t.fontSize?+t.fontSize.substring(0,t.fontSize.indexOf('px')):14;return isNaN(i)&&(i=14),{font:{bold:t&&t.fontWeight&&(t.fontWeight==='bold'||!isNaN(+t.fontWeight)&&+t.fontWeight>=700),italic:t&&t.fontStyle&&t.fontStyle==='italic',underline:t&&t.textDecoration&&t.textDecoration==='underline',family:t?this._parseToExcelFontFamily(t.fontFamily):'Arial',size:i,color:t&&t.color?t.color:undefined},fill:{color:t&&t.backgroundColor?t.backgroundColor:undefined},hAlign:t&&t.textAlign?n.xlsx.XlsxConverter._parseStringToHAlign(t.textAlign):undefined}},i._parseToExcelFontFamily=function(n){var t;return n?(t=n.split(','),t&&t.length>0&&(n=t[0].replace(/\"|\'/g,''))):n='Arial',n},i._parseToExcelFormula=function(t,i){var u=t.substring(1,t.indexOf('(')).toLowerCase(),r;switch(u){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(')'))+', 1)';break;case'text':r=t.substring(t.lastIndexOf(','),t.lastIndexOf('\"'));r=n.xlsx.XlsxConverter._parseCellFormat(r.substring(r.lastIndexOf('\"')+1),i);t=t.substring(0,t.lastIndexOf(',')+1)+'\"'+r+'\")'}return t},i._parseToFlexSheetFormula=function(t){var u=t.substring(1).match(/\W+(\w+)\(/),r,f,e,o,i;f=u&&u.length===2?u[1]:t.substring(1,t.indexOf('('));e=t.indexOf(f);switch(f.toLowerCase()){case'ceiling':case'floor':t=t.substring(0,t.lastIndexOf(','))+')';break;case'text':r=t.substring(e);i=r.substring(r.indexOf('\"'),r.lastIndexOf('\"'));i=i.substring(i.lastIndexOf('\"')+1);o=i.indexOf('0')>-1?0:'';i=n.xlsx.XlsxConverter._parseExcelFormat({value:o,style:{format:i}});i=i.replace(/m+/g,function(n){return n.toUpperCase()}).replace(/Y+/g,function(n){return n.toLowerCase()}).replace(/M+:?|:?M+/gi,function(n){return n.indexOf(':')>-1?n.toLowerCase():n});t=t.substring(0,e)+r.substring(0,r.indexOf('\"')+1)+i+'\")'}return t},i._getColumnSetting=function(t,i){var r=t.renderWidth;return r=r||i,{autoWidth:!0,width:r,visible:t.visible,style:{format:t.format?n.xlsx.XlsxConverter._parseCellFormat(t.format,t.dataType===4):'',hAlign:n.xlsx.XlsxConverter._parseStringToHAlign(this._toExcelHAlign(t.getAlignment()))}}},i._toExcelHAlign=function(n){return(n=n?n.trim().toLowerCase():n,!n)?n:n.indexOf('center')>-1?'center':n.indexOf('right')>-1||n.indexOf('end')>-1?'right':n.indexOf('justify')>-1?'justify':'left'},i._getColumnCount=function(n){for(var r=0,t,i=0;i<n.length;i++)t=n[i]?n[i].cells:[],t&&t.length>r&&(r=t.length);return r},i._numAlpha=function(n){var t=Math.floor(n/26)-1;return(t>-1?this._numAlpha(t):'')+String.fromCharCode(65+n%26)},i._getItemType=function(t){return t===undefined||t===null||t.value===undefined||t.value===null||isNaN(t.value)?undefined:n.getType(t.value)},i._setColumn=function(t,i,r){var f,e,o,u=t[i];u?(f=this._getItemType(r),u.dataType!==f&&f!=undefined&&u.dataType===3&&f!==3&&(u.dataType=f),e=n.xlsx.XlsxConverter._parseExcelFormat(r),e&&u.format!==e&&e!=='General'&&(u.format=e),r&&r.style&&r.style.hAlign&&(o=n.xlsx.XlsxConverter._parseHAlignToString(n.asEnum(r.style.hAlign,n.xlsx.HAlign))),o||f!==2||(o='right'),u.hAlign=o):t[i]={dataType:this._getItemType(r),format:n.xlsx.XlsxConverter._parseExcelFormat(r),hAlign:''}},i._getItemValue=function(t){if(t===undefined||t===null||t.value===undefined||t.value===null)return undefined;var i=t.value;return n.isNumber(i)&&isNaN(i)?'':i instanceof Date&&isNaN(i.getTime())?'':i},i._getCellStyle=function(n,t,i,r){try{this._resetCellStyle(t);n.grid.cellFactory.updateCell(n,i,r,t)}catch(u){return undefined}return window.getComputedStyle(t)},i._resetCellStyle=function(n){var i=Object.prototype.hasOwnProperty;for(var t in n.style)i.call(n.style,t)&&typeof n.style[t]=='string'&&isNaN(+t)&&(n.style[t]='')},i._extend=function(t,i){var r,u;for(r in i)u=i[r],n.isObject(u)&&t[r]?n.copy(t[r],u):t[r]=u;return t},i._checkParentCollapsed=function(n,t){var i=!1;return Object.keys(n).forEach(function(r){n[r]===!0&&i===!1&&!isNaN(t)&&+r<t&&(i=!0)}),i},i}();i.FlexGridXlsxConverter=r})(t.xlsx||(t.xlsx={}));var i=t.xlsx})(n.grid||(n.grid={}));var t=n.grid})(wijmo||(wijmo={}))